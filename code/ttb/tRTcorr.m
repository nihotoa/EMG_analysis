function tRTcorr% Check ParametersAnalysisObjects = gsma;nAnalyses = length(AnalysisObjects);if nAnalyses < 1   disp('PeakAreas: No selected analysis -- nothing to do')   return;end% fprintf(fid,'FileName\tSpike\tTrigger\tComponents\tnTrials\tBaseStart(ms)\tBaseEnd(ms)\tBaseMean(Hz)\tBaseSTD(Hz)\tStart(ms)\tStartValue(Hz)\tEnd(ms)\tEndValue(Hz)\tPeakTime(ms)\tPeak(Hz)\tMean(Hz)\tp\t(<0.05)\n');for ana = 1:nAnalyses   analysisName = get(AnalysisObjects(ana), 'Name');   FullName = get(AnalysisObjects(ana), 'FullName');   AnalysesComponents = analyses(AnalysisObjects(ana), 'componentobjs');   nAnalysesComponents = length(AnalysesComponents);   if nAnalysesComponents == 0      disp(['PeakAreas: No components to do: ' analysisName]);      break;   end   maxTrials = 0;   for i = 1:nAnalysesComponents      analysisType = get(AnalysesComponents(i), 'SubClass');      TargetName = get(AnalysesComponents(i), 'Target');      TimeUnits = get(AnalysesComponents(i), 'TimeUnits');%       YDataUnits = get(AnalysesComponents(i), 'YUnits');      ConversionFactor = units('conversionfactor', 'time', TimeUnits, 'milliseconds');           WindowStart = get(AnalysesComponents(i), 'WindowStart') * ConversionFactor;      WindowStop = get(AnalysesComponents(i), 'WindowStop') * ConversionFactor;      xData = get(AnalysesComponents(i), 'XData') * ConversionFactor;      trialData = get(AnalysesComponents(i), 'TrialData');      trialTimes = get(AnalysesComponents(i), 'TrialTriggerTime');%       TrialsToUse   = get(AnalysesComponents(i), 'TrialsToUse');%       nTotalTrials = get(AnalysesComponents(i), 'TrialCount');      nTrials = size(trialData, 1);      name = get(AnalysesComponents(i), 'Name'); %       disp(name)            switch TargetName          case {'Spike1','Spike2','Spike3'}%               Datalabel{1}  = 'PeakFR(Hz)';   %for Pre-peak1/2              Datalabel{1}  = 'TroughFR(Hz)';   %for Pre-trough2/2              for ii=1:nTrials                  tempData  = trialData{ii};%                   xtempData  = trialData{ii} * ConversionFactor;                  if(length(tempData)<2)                      Data(ii,1)    = NaN;%                       DataTime(ii,1)    = NaN;                  else                      tempData  = [0,1./(tempData(2:length(tempData))-tempData(1:length(tempData)-1))]; %Hz                      tempData  = conv(tempData,ones(1,4))/4;                      tempData(1:3) =[];%                       [Data(ii,1),ind]    = max(tempData);  %for Pre-peak2/2                      [Data(ii,1),ind]    = min(tempData);    %for Pre-trough2/2%                       DataTime(ii,1)    =xtempData(ind);                  end              end              spikeName = get(AnalysesComponents(i), 'Target');          case 'Grip Onset'              Datalabel{2}  = 'RT(ms)';              for ii=1:nTrials                  if(isempty(trialData{ii,1}))                      Data(ii,2)    = NaN;                  else                      Data(ii,2) = trialData{ii,1}* ConversionFactor;                  end              end      end                                end  %for i = 1:nAnalysesComponents   end     %for ana = 1:nAnalysesload TrialsToUseSet.mateval(['TrialsToUse   = TrialsToUseSet.',analysisName,'.',spikeName,';']);Data  = Data(TrialsToUse,:);% DataTime  = DataTime(TrialsToUse,:);filename    =sprintf('c:\\data\\RTcorr%s-%s.xls',analysisName,spikeName);disp(filename)fid = fopen(filename,'a');fprintf(fid,'no');for ii=1:length(Datalabel)    fprintf(fid,'\t%s',Datalabel{ii});end% for ii=1:length(DataTimelabel)%     fprintf(fid,'\t%s',DataTimelabel{ii});% endfprintf(fid,'\n');% for jj=1:size(Data,1)    fprintf(fid,'%d',jj);    for ii=1:size(Data,2);        fprintf(fid,'\t%f',Data(jj,ii));    end%     for ii=1:size(DataTime,2);%         fprintf(fid,'\t%f',DataTime(jj,ii));%     end    fprintf(fid,'\n');endfclose(fid);