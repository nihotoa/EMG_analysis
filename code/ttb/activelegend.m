function activelegend(h,strings,marker_flag,line_flag,varargin)
% activelegend(h,strings,marker_flag,line_flag,varargin)


styles  = {[0.00   0.00    0.75], '-', 'o';...
    [0.00   0.50    0.00], '-', 'o';...
    [0.75   0.00    0.00], '-', 'o';...
    [0.00   0.75    0.75], '-', 'o';...
    [0.75   0.00    0.75], '-', 'o';...
    [0.75   0.75    0.00], '-', 'o';...    [0.25   0.25    0.25], '-';...
    [0.00   0.00    0.75], '--', 's';...
    [0.00   0.50    0.00], '--', 's';...
    [0.75   0.00    0.00], '--', 's';...
    [0.00   0.75    0.75], '--', 's';...
    [0.75   0.00    0.75], '--', 's';...
    [0.75   0.75    0.00], '--', 's';...    [0.25   0.25    0.25], '--';...
    [0.00   0.00    0.75], '-.', 'd';...
    [0.00   0.50    0.00], '-.', 'd';...
    [0.75   0.00    0.00], '-.', 'd';...
    [0.00   0.75    0.75], '-.', 'd';...
    [0.75   0.00    0.75], '-.', 'd';...
    [0.75   0.75    0.00], '-.', 'd';...    [0.25   0.25    0.25], '-.';...
    [0.00   0.00    0.75], ':', '+';...
    [0.00   0.50    0.00], ':', '+';...
    [0.75   0.00    0.00], ':', '+';...
    [0.00   0.75    0.75], ':', '+';...
    [0.75   0.00    0.75], ':', '+';...
    [0.75   0.75    0.00], ':', '+'};    %;...    [0.25   0.25    0.25], ':'};

nstyle  = size(styles,1);
nh      = length(h);


for ih  = 1:nh
    ind = mod(ih-1,nstyle) + 1;
    if(marker_flag && line_flag)
        set(h(ih),'Color',styles{ind,1},'LineStyle',styles{ind,2},'MarkerFaceColor',styles{ind,1},'MarkerEdgeColor',styles{ind,1},'Marker',styles{ind,3});
    elseif(marker_flag && ~line_flag)
        set(h(ih),'Color',styles{ind,1},'LineStyle','none','MarkerFaceColor',styles{ind,1},'MarkerEdgeColor',styles{ind,1},'Marker',styles{ind,3});
    else
        set(h(ih),'Color',styles{ind,1},'LineStyle',styles{ind,2},'MarkerFaceColor',styles{ind,1},'MarkerEdgeColor',styles{ind,1},'Marker','none');
    end
end

if nargin<1
    legend(h,strings);
else
    legend(h,strings,varargin{:});
end